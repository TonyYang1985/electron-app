# 创建简单图标的PowerShell脚本
# 以管理员身份运行PowerShell，然后执行此脚本

Write-Host "正在创建应用图标..." -ForegroundColor Green

# assets
$assetsDir = "assets"
if (!(Test-Path $assetsDir)) {
    New-Item -ItemType Directory -Path $assetsDir
    Write-Host "已创建 $assetsDir 目录" -ForegroundColor Yellow
}

# 方法1: 下载免费图标
Write-Host "正在下载免费图标..." -ForegroundColor Cyan

try {
    # 下载一个免费的应用图标（PNG格式）
    $iconUrl = "https://cdn-icons-png.flaticon.com/256/3659/3659898.png"
    $iconPath = "$assetsDir\icon.png"
    
    Invoke-WebRequest -Uri $iconUrl -OutFile $iconPath -ErrorAction Stop
    Write-Host "✅ 已下载图标: $iconPath" -ForegroundColor Green
    
    # 转换为ICO格式（Windows需要）
    Write-Host "正在转换为ICO格式..." -ForegroundColor Cyan
    
    # 使用在线API转换（如果有网络）
    $icoUrl = "https://convertio.co/api/convert/"  # 这只是示例，实际需要API密钥
    
    Write-Host "⚠️ 请手动将 icon.png 转换为 icon.ico" -ForegroundColor Yellow
    Write-Host "推荐使用在线工具: https://www.icoconverter.com/" -ForegroundColor Cyan
    
} catch {
    Write-Host "⚠️ 下载失败，请手动创建图标文件" -ForegroundColor Yellow
}

# 方法2: 创建图标文件说明
$iconReadme = @"
# 图标文件说明

请将以下图标文件放在此目录中：

## 必需文件：
1. icon.png - 256x256像素，用于Linux和通用用途
2. icon.ico - Windows图标，包含多个尺寸
3. icon.icns - macOS图标（可选）

## 在线图标生成工具：
- https://www.icoconverter.com/ - 免费转换PNG到ICO
- https://appicon.co/ - 专业应用图标生成器
- https://www.canva.com/ - 在线图标设计

## 快速解决方案：
如果暂时没有图标，可以：
1. 在package.json中注释掉所有icon配置
2. 使用默认Electron图标进行测试
3. 后续再添加自定义图标

## 临时跳过图标：
在package.json的build配置中注释掉：
- win.icon
- mac.icon  
- linux.icon
"@

$iconReadme | Out-File -FilePath "$assetsDir\README.md" -Encoding UTF8

Write-Host "✅ 已创建图标说明文件: $assetsDir\README.md" -ForegroundColor Green

# 显示下一步操作
Write-Host "`n📋 下一步操作：" -ForegroundColor Magenta
Write-Host "1. 访问 https://www.icoconverter.com/" -ForegroundColor White
Write-Host "2. 上传一张PNG图片，生成ICO文件" -ForegroundColor White
Write-Host "3. 下载生成的ICO文件，重命名为 icon.ico" -ForegroundColor White
Write-Host "4. 将 icon.ico 放入 assets 目录" -ForegroundColor White
Write-Host "5. 重新运行构建命令" -ForegroundColor White

Write-Host "`n🚀 或者先跳过图标，直接测试构建：" -ForegroundColor Magenta
Write-Host "npm run build:win" -ForegroundColor Yellow